<%- include ('../header') %>
<%- include ('../../../partials/sidebar') %>
    <section id="content">
        <div class="container">
            <div class="card">
                <div class="card-header">
                    <div class="pull-left"><h2>Cuisines List</h2></div>
                    <div class="pull-right"><a href="<%- adminpath %>cuisines/add"><button class="btn btn-primary waves-effect">Add Cuisines</button></a></div>
                </div>
                <table id="data-table-command" class="table table-striped table-vmiddle">
                    <thead>
                        <tr>
                            <th data-column-id="id" data-visible="false">ID</th>
                            <th data-column-id="name">Name</th>
                            <th data-column-id="Status" data-visible="false">Status</th>
                            <th data-column-id="commands" data-formatter="commands" data-sortable="false">Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                       <% for(var t=0;t<data.length;t++) { %>
                        <tr>
                            <td><%- data[t].id %></td> 
                            <td><%- data[t].name %></td>
                            <% if(data[t].status == '1'){ %>
                                <td>Active</td>
                            <% }else{ %>
                                <td>InActive</td>
                            <% } %>
                        </tr>
                        <% } %>
                    </tbody>
                </table>
            </div>
        </div>
    </section>
</section>
<%- include ('../../../partials/commonJs') %>

    <script type="text/javascript">
        $(function() {
            $('#cuisineTab').addClass('active');
            $('#cuisineTab a[href^="<%- adminpath %>cuisines"]').addClass('active');
        });
            $(document).ready(function(){

                               //Command Buttons
                var grid = $("#data-table-command").bootgrid({
                    caseSensitive: false,
                    css: {
                        icon: 'zmdi icon',
                        iconColumns: 'zmdi-view-module',
                        iconDown: 'zmdi-expand-more',
                        iconRefresh: 'zmdi-refresh',
                        iconUp: 'zmdi-expand-less'
                    },
                    formatters: {
                        "commands": function(column, row) {
                            if(row.Status == "Active")
                            {
                                var toggle = "<div title=\"Active\" class=\"toggle-switch command-block\" data-row-id=\"" + row.id + "\" data-ts-color=\"green\"><input title=\"Active\" id=\"ts4" + row.id + "\" hidden=\"hidden\" type=\"checkbox\" data-row-id=\"" + row.id + "\" checked> <label title=\"Active\" for=\"ts4" + row.id + "\" class=\"ts-helper\"></label></div>";
                            }else{
                                var toggle = "<div title=\"Unactive\" class=\"toggle-switch command-unblock\" data-row-id=\"" + row.id + "\" data-ts-color=\"green\"><input title=\"Unactive\" id=\"ts2" + row.id + "\" hidden=\"hidden\" type=\"checkbox\" data-row-id=\"" + row.id + "\"> <label title=\"Unactive\" for=\"ts2" + row.id + "\" class=\"ts-helper\"></label></div>";
                            }

                            return "<button type=\"button\" class=\"btn btn-icon command-edit waves-effect waves-circle\" data-row-id=\"" + row.id + "\"><span class=\"zmdi zmdi-edit\"></span></button> " +
                            toggle;
                            
                        }
                    }
                }).on("loaded.rs.jquery.bootgrid", function()
                {
                    /* Executes after data is loaded and rendered */
                    grid.find(".command-edit").on("click", function(e)
                    {
                        window.location.href="<%-adminpath%>cuisines/view/"+$(this).data("row-id");
                    }).end().find(".command-block").on("click", function(e)
                    {
                        var id = $(this).data("row-id");
                        console.log(id);
                        $.ajax({
                            type: 'POST',
                            url: '<%-adminpath%>cuisines/status/',
                            data: {'id': id,'status': '0'},
                            dataType: 'json',
                            success: function (response) {
                                if (response.code == '200') {
                                   showToastSuccess("Cuisines block successfully");
                                   //$(".page-loader").hide();
                                   setTimeout(function(){ window.location.reload(); },1000);
                                }
                                else
                                {
                                   //$(".page-loader").hide();
                                    showToastError(response.message)
                                }
                            }
                        });    
                    }).end().find(".command-unblock").on("click", function(e)
                    {
                        var id = $(this).data("row-id");
                        console.log(id);
                        $.ajax({
                            type: 'POST',
                            url: '<%-adminpath%>cuisines/status/',
                            data: {'id': id,'status': '1'},
                            dataType: 'json',
                            success: function (response) {
                                if (response.code == '200') {
                                   showToastSuccess("Cuisines active successfully");
                                   //$(".page-loader").hide();
                                   setTimeout(function(){ window.location.reload(); },1000);
                                }
                                else{
                                   //$(".page-loader").hide();
                                    showToastError(response.message)
                                }
                            }
                        }); 
                    });
                })
            });
        </script>
  